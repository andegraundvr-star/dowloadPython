#Последовательность Хофштадтера
"""Реализуйте генерацию последовательности Q Хофштадтера (итератором или генератором). Сама последовательность выглядит так:

Q(n)=Q(n−Q(n−1))+Q(n−Q(n−2))

В итератор (или генератор) передаётся список из двух чисел. Например, QHofstadter([1, 1]) генерирует точную последовательность Хофштадтера. Если передать значения [1, 2], то последовательность должна немедленно завершиться."""
#создание самой функции, если переданы не [1, 1], последовательность завершается
def QHofstadter(sequence):
    #проверяем начальные условия
    if sequence != [1, 1]:
        print("Последовательность должна начинаться с [1, 1]")
        return
    #yield начальные значения
    yield sequence[0]
    yield sequence[1]
    #основная генерация последовательности
    n = 2  #начинаем с третьего элемента, индекс 2
    #создание копии входного списка
    Q_sequence = sequence.copy()

    while True:
        try:
            #вычисляем следующий элемент по формуле Q(n) = Q(n - Q(n-1)) + Q(n - Q(n-2))
            next_value = Q_sequence[n - Q_sequence[n-1]] + Q_sequence[n - Q_sequence[n-2]]
            #обновляем данные: добавляем вычисленное значение в конец списка
            Q_sequence.append(next_value)
            #возвращаем вычисленное значение как элемент генератора
            yield next_value
            #увеличиваем счетчик для следующей итерации
            n += 1
        except IndexError:
            # Завершаем при выходе за границы
            break

#использование
#ввод начальных условий
try:
    x = int(input("Введите x: "))
    y = int(input("Введите y: "))
except ValueError:
    print("Ошибка: введите целые числа!")
    exit()
#создаем начальную последовательность
initial_sequence = [x, y]
#создаем генератор
gen = QHofstadter(initial_sequence)

#выводим последовательность
print(f"Последовательность Хофштадтера для {initial_sequence}:")
try:
    for i, value in enumerate(gen):
        print(f"Q({i}) = {value}")
        if i >= 50:  #ограничиваем вывод для демонстрации
            break
except Exception as e:
    print(f"Последовательность завершена: {e}")